<script setup>
import { onMounted, ref } from 'vue';
import { weatherPromise } from '../scripts/weather';

onMounted(() => {
  setWeather();
});
const icon = ref('ban');
const temp = ref('-');
const description = ref('Unknown');

const weather = ref(await weatherPromise); // the error here is a mistake. Node and Vue both support top level await.

const setWeather = () => {
  temp.value = weather.value.temperature;

  const words = weather.value.description.split(' ');
  for (let i = 0; i < words.length; i++) {
    words[i] = words[i][0].toUpperCase() + words[i].substr(1);
  }
  let caps = words.join(' ');
  description.value = caps;

  icon.value = `https://openweathermap.org/img/wn/${weather.value.iconId}@2x.png`;
};
</script>

<template>
  <div class="weather flex align-center justify-center">
    <div class="weatherIcon w-16 h-16">
      <img :src="icon" />
    </div>
    <div class="weatherValue text-3xl font-black font-sans ml-4">
      <p>{{ temp }}Â°</p>
    </div>
    <div class="weatherDescription text-2xl font-sans mt-1 ml-2">
      <p>{{ description }}</p>
    </div>
  </div>
</template>
